{"payload":{"allShortcutsEnabled":false,"fileTree":{"":{"items":[{"name":"README.md","path":"README.md","contentType":"file"},{"name":"app.py","path":"app.py","contentType":"file"},{"name":"main.py","path":"main.py","contentType":"file"},{"name":"test.py","path":"test.py","contentType":"file"}],"totalCount":4}},"fileTreeProcessingTime":1.46042,"foldersToFetch":[],"repo":{"id":402063234,"defaultBranch":"main","name":"fashion-recommender-system","ownerLogin":"campusx-official","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2021-09-01T13:03:57.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/53361867?v=4","public":true,"private":false,"isOrgOwned":false},"symbolsExpanded":false,"treeExpanded":true,"refInfo":{"name":"main","listCacheKey":"v0:1630501544.14429","canEdit":false,"refType":"branch","currentOid":"e230815971b8f5e261340866398a06b7675a1bbd"},"path":"app.py","currentUser":null,"blob":{"rawLines":["import tensorflow\r","from tensorflow.keras.preprocessing import image\r","from tensorflow.keras.layers import GlobalMaxPooling2D\r","from tensorflow.keras.applications.resnet50 import ResNet50,preprocess_input\r","import numpy as np\r","from numpy.linalg import norm\r","import os\r","from tqdm import tqdm\r","import pickle\r","\r","model = ResNet50(weights='imagenet',include_top=False,input_shape=(224,224,3))\r","model.trainable = False\r","\r","model = tensorflow.keras.Sequential([\r","    model,\r","    GlobalMaxPooling2D()\r","])\r","\r","#print(model.summary())\r","\r","def extract_features(img_path,model):\r","    img = image.load_img(img_path,target_size=(224,224))\r","    img_array = image.img_to_array(img)\r","    expanded_img_array = np.expand_dims(img_array, axis=0)\r","    preprocessed_img = preprocess_input(expanded_img_array)\r","    result = model.predict(preprocessed_img).flatten()\r","    normalized_result = result / norm(result)\r","\r","    return normalized_result\r","\r","filenames = []\r","\r","for file in os.listdir('images'):\r","    filenames.append(os.path.join('images',file))\r","\r","feature_list = []\r","\r","for file in tqdm(filenames):\r","    feature_list.append(extract_features(file,model))\r","\r","pickle.dump(feature_list,open('embeddings.pkl','wb'))\r","pickle.dump(filenames,open('filenames.pkl','wb'))\r","\r"],"stylingDirectives":[[{"start":0,"end":6,"cssClass":"pl-k"},{"start":7,"end":17,"cssClass":"pl-s1"}],[{"start":0,"end":4,"cssClass":"pl-k"},{"start":5,"end":15,"cssClass":"pl-s1"},{"start":16,"end":21,"cssClass":"pl-s1"},{"start":22,"end":35,"cssClass":"pl-s1"},{"start":36,"end":42,"cssClass":"pl-k"},{"start":43,"end":48,"cssClass":"pl-s1"}],[{"start":0,"end":4,"cssClass":"pl-k"},{"start":5,"end":15,"cssClass":"pl-s1"},{"start":16,"end":21,"cssClass":"pl-s1"},{"start":22,"end":28,"cssClass":"pl-s1"},{"start":29,"end":35,"cssClass":"pl-k"},{"start":36,"end":54,"cssClass":"pl-v"}],[{"start":0,"end":4,"cssClass":"pl-k"},{"start":5,"end":15,"cssClass":"pl-s1"},{"start":16,"end":21,"cssClass":"pl-s1"},{"start":22,"end":34,"cssClass":"pl-s1"},{"start":35,"end":43,"cssClass":"pl-s1"},{"start":44,"end":50,"cssClass":"pl-k"},{"start":51,"end":59,"cssClass":"pl-v"},{"start":60,"end":76,"cssClass":"pl-s1"}],[{"start":0,"end":6,"cssClass":"pl-k"},{"start":7,"end":12,"cssClass":"pl-s1"},{"start":13,"end":15,"cssClass":"pl-k"},{"start":16,"end":18,"cssClass":"pl-s1"}],[{"start":0,"end":4,"cssClass":"pl-k"},{"start":5,"end":10,"cssClass":"pl-s1"},{"start":11,"end":17,"cssClass":"pl-s1"},{"start":18,"end":24,"cssClass":"pl-k"},{"start":25,"end":29,"cssClass":"pl-s1"}],[{"start":0,"end":6,"cssClass":"pl-k"},{"start":7,"end":9,"cssClass":"pl-s1"}],[{"start":0,"end":4,"cssClass":"pl-k"},{"start":5,"end":9,"cssClass":"pl-s1"},{"start":10,"end":16,"cssClass":"pl-k"},{"start":17,"end":21,"cssClass":"pl-s1"}],[{"start":0,"end":6,"cssClass":"pl-k"},{"start":7,"end":13,"cssClass":"pl-s1"}],[],[{"start":0,"end":5,"cssClass":"pl-s1"},{"start":6,"end":7,"cssClass":"pl-c1"},{"start":8,"end":16,"cssClass":"pl-v"},{"start":17,"end":24,"cssClass":"pl-s1"},{"start":24,"end":25,"cssClass":"pl-c1"},{"start":25,"end":35,"cssClass":"pl-s"},{"start":36,"end":47,"cssClass":"pl-s1"},{"start":47,"end":48,"cssClass":"pl-c1"},{"start":48,"end":53,"cssClass":"pl-c1"},{"start":54,"end":65,"cssClass":"pl-s1"},{"start":65,"end":66,"cssClass":"pl-c1"},{"start":67,"end":70,"cssClass":"pl-c1"},{"start":71,"end":74,"cssClass":"pl-c1"},{"start":75,"end":76,"cssClass":"pl-c1"}],[{"start":0,"end":5,"cssClass":"pl-s1"},{"start":6,"end":15,"cssClass":"pl-s1"},{"start":16,"end":17,"cssClass":"pl-c1"},{"start":18,"end":23,"cssClass":"pl-c1"}],[],[{"start":0,"end":5,"cssClass":"pl-s1"},{"start":6,"end":7,"cssClass":"pl-c1"},{"start":8,"end":18,"cssClass":"pl-s1"},{"start":19,"end":24,"cssClass":"pl-s1"},{"start":25,"end":35,"cssClass":"pl-v"}],[{"start":4,"end":9,"cssClass":"pl-s1"}],[{"start":4,"end":22,"cssClass":"pl-v"}],[],[],[{"start":0,"end":24,"cssClass":"pl-c"}],[],[{"start":0,"end":3,"cssClass":"pl-k"},{"start":4,"end":20,"cssClass":"pl-en"},{"start":21,"end":29,"cssClass":"pl-s1"},{"start":30,"end":35,"cssClass":"pl-s1"}],[{"start":4,"end":7,"cssClass":"pl-s1"},{"start":8,"end":9,"cssClass":"pl-c1"},{"start":10,"end":15,"cssClass":"pl-s1"},{"start":16,"end":24,"cssClass":"pl-en"},{"start":25,"end":33,"cssClass":"pl-s1"},{"start":34,"end":45,"cssClass":"pl-s1"},{"start":45,"end":46,"cssClass":"pl-c1"},{"start":47,"end":50,"cssClass":"pl-c1"},{"start":51,"end":54,"cssClass":"pl-c1"}],[{"start":4,"end":13,"cssClass":"pl-s1"},{"start":14,"end":15,"cssClass":"pl-c1"},{"start":16,"end":21,"cssClass":"pl-s1"},{"start":22,"end":34,"cssClass":"pl-en"},{"start":35,"end":38,"cssClass":"pl-s1"}],[{"start":4,"end":22,"cssClass":"pl-s1"},{"start":23,"end":24,"cssClass":"pl-c1"},{"start":25,"end":27,"cssClass":"pl-s1"},{"start":28,"end":39,"cssClass":"pl-en"},{"start":40,"end":49,"cssClass":"pl-s1"},{"start":51,"end":55,"cssClass":"pl-s1"},{"start":55,"end":56,"cssClass":"pl-c1"},{"start":56,"end":57,"cssClass":"pl-c1"}],[{"start":4,"end":20,"cssClass":"pl-s1"},{"start":21,"end":22,"cssClass":"pl-c1"},{"start":23,"end":39,"cssClass":"pl-en"},{"start":40,"end":58,"cssClass":"pl-s1"}],[{"start":4,"end":10,"cssClass":"pl-s1"},{"start":11,"end":12,"cssClass":"pl-c1"},{"start":13,"end":18,"cssClass":"pl-s1"},{"start":19,"end":26,"cssClass":"pl-en"},{"start":27,"end":43,"cssClass":"pl-s1"},{"start":45,"end":52,"cssClass":"pl-en"}],[{"start":4,"end":21,"cssClass":"pl-s1"},{"start":22,"end":23,"cssClass":"pl-c1"},{"start":24,"end":30,"cssClass":"pl-s1"},{"start":31,"end":32,"cssClass":"pl-c1"},{"start":33,"end":37,"cssClass":"pl-en"},{"start":38,"end":44,"cssClass":"pl-s1"}],[],[{"start":4,"end":10,"cssClass":"pl-k"},{"start":11,"end":28,"cssClass":"pl-s1"}],[],[{"start":0,"end":9,"cssClass":"pl-s1"},{"start":10,"end":11,"cssClass":"pl-c1"}],[],[{"start":0,"end":3,"cssClass":"pl-k"},{"start":4,"end":8,"cssClass":"pl-s1"},{"start":9,"end":11,"cssClass":"pl-c1"},{"start":12,"end":14,"cssClass":"pl-s1"},{"start":15,"end":22,"cssClass":"pl-en"},{"start":23,"end":31,"cssClass":"pl-s"}],[{"start":4,"end":13,"cssClass":"pl-s1"},{"start":14,"end":20,"cssClass":"pl-en"},{"start":21,"end":23,"cssClass":"pl-s1"},{"start":24,"end":28,"cssClass":"pl-s1"},{"start":29,"end":33,"cssClass":"pl-en"},{"start":34,"end":42,"cssClass":"pl-s"},{"start":43,"end":47,"cssClass":"pl-s1"}],[],[{"start":0,"end":12,"cssClass":"pl-s1"},{"start":13,"end":14,"cssClass":"pl-c1"}],[],[{"start":0,"end":3,"cssClass":"pl-k"},{"start":4,"end":8,"cssClass":"pl-s1"},{"start":9,"end":11,"cssClass":"pl-c1"},{"start":12,"end":16,"cssClass":"pl-en"},{"start":17,"end":26,"cssClass":"pl-s1"}],[{"start":4,"end":16,"cssClass":"pl-s1"},{"start":17,"end":23,"cssClass":"pl-en"},{"start":24,"end":40,"cssClass":"pl-en"},{"start":41,"end":45,"cssClass":"pl-s1"},{"start":46,"end":51,"cssClass":"pl-s1"}],[],[{"start":0,"end":6,"cssClass":"pl-s1"},{"start":7,"end":11,"cssClass":"pl-en"},{"start":12,"end":24,"cssClass":"pl-s1"},{"start":25,"end":29,"cssClass":"pl-en"},{"start":30,"end":46,"cssClass":"pl-s"},{"start":47,"end":51,"cssClass":"pl-s"}],[{"start":0,"end":6,"cssClass":"pl-s1"},{"start":7,"end":11,"cssClass":"pl-en"},{"start":12,"end":21,"cssClass":"pl-s1"},{"start":22,"end":26,"cssClass":"pl-en"},{"start":27,"end":42,"cssClass":"pl-s"},{"start":43,"end":47,"cssClass":"pl-s"}],[]],"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/campusx-official/fashion-recommender-system/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":null},"displayName":"app.py","displayUrl":"https://github.com/campusx-official/fashion-recommender-system/blob/main/app.py?raw=true","headerInfo":{"blobSize":"1.21 KB","deleteTooltip":"You must be signed in to make or propose changes","editTooltip":"You must be signed in to make or propose changes","ghDesktopPath":"https://desktop.github.com","isGitLfs":false,"onBranch":true,"shortPath":"e885f64","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Fcampusx-official%2Ffashion-recommender-system%2Fblob%2Fmain%2Fapp.py","isCSV":false,"isRichtext":false,"toc":null,"lineInfo":{"truncatedLoc":"43","truncatedSloc":"32"},"mode":"file"},"image":false,"isCodeownersFile":null,"isPlain":false,"isValidLegacyIssueTemplate":false,"issueTemplate":null,"discussionTemplate":null,"language":"Python","languageID":303,"large":false,"planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/campusx-official/fashion-recommender-system/blob/main/app.py","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","releasePath":"/campusx-official/fashion-recommender-system/releases/new?marketplace=true","showPublishActionBanner":false},"rawBlobUrl":"https://github.com/campusx-official/fashion-recommender-system/raw/main/app.py","renderImageOrRaw":false,"richText":null,"renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timed_out":false,"not_analyzed":false,"symbols":[{"name":"model","kind":"constant","ident_start":305,"ident_end":310,"extent_start":305,"extent_end":383,"fully_qualified_name":"model","ident_utf16":{"start":{"line_number":10,"utf16_col":0},"end":{"line_number":10,"utf16_col":5}},"extent_utf16":{"start":{"line_number":10,"utf16_col":0},"end":{"line_number":10,"utf16_col":78}}},{"name":"model","kind":"constant","ident_start":412,"ident_end":417,"extent_start":412,"extent_end":491,"fully_qualified_name":"model","ident_utf16":{"start":{"line_number":13,"utf16_col":0},"end":{"line_number":13,"utf16_col":5}},"extent_utf16":{"start":{"line_number":13,"utf16_col":0},"end":{"line_number":16,"utf16_col":2}}},{"name":"extract_features","kind":"function","ident_start":526,"ident_end":542,"extent_start":522,"extent_end":914,"fully_qualified_name":"extract_features","ident_utf16":{"start":{"line_number":20,"utf16_col":4},"end":{"line_number":20,"utf16_col":20}},"extent_utf16":{"start":{"line_number":20,"utf16_col":0},"end":{"line_number":28,"utf16_col":28}}},{"name":"filenames","kind":"constant","ident_start":918,"ident_end":927,"extent_start":918,"extent_end":932,"fully_qualified_name":"filenames","ident_utf16":{"start":{"line_number":30,"utf16_col":0},"end":{"line_number":30,"utf16_col":9}},"extent_utf16":{"start":{"line_number":30,"utf16_col":0},"end":{"line_number":30,"utf16_col":14}}},{"name":"feature_list","kind":"constant","ident_start":1024,"ident_end":1036,"extent_start":1024,"extent_end":1041,"fully_qualified_name":"feature_list","ident_utf16":{"start":{"line_number":35,"utf16_col":0},"end":{"line_number":35,"utf16_col":12}},"extent_utf16":{"start":{"line_number":35,"utf16_col":0},"end":{"line_number":35,"utf16_col":17}}}]}},"copilotInfo":null,"copilotAccessAllowed":false,"csrf_tokens":{"/campusx-official/fashion-recommender-system/branches":{"post":"isuwNkK14N6F53FS9D8k7IosWn7cqSz-hxWJwU6ZTo7Bwvw32UHckTXGGiHdRhdokcgftuCSmGz1QT8yq4boEA"},"/repos/preferences":{"post":"OvZqGkEts2gk35PhAUBstb5br4DWVM0t1pFgJPYJ9FKmW4pBVfylAi77E55z2yvskke2eB6PjFrNfLssTovPEQ"}}},"title":"fashion-recommender-system/app.py at main Â· campusx-official/fashion-recommender-system"}